<?xml version="1.0"?>
<!-- @(#)STI-TAG_Topology.xsd
Copyright (c) systransis Ltd.
All rights reserved.
-->

<xs:schema version="1.0"
           xmlns:xs="http://www.w3.org/2001/XMLSchema"
           elementFormDefault="qualified">
    <!-- attribute type declarations -->
    <xs:simpleType name="DescTypeEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="Mileage"/>
            <xs:enumeration value="Location"/>
        </xs:restriction>
    </xs:simpleType>
    <xs:simpleType name="MileageOrientationEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="Downwards"/>
            <xs:enumeration value="Upwards"/>
            <xs:enumeration value="any"/>
            <xs:enumeration value="down"/>
            <xs:enumeration value="up"/>
            <xs:enumeration value="D"/>
            <xs:enumeration value="U"/>
        </xs:restriction>
    </xs:simpleType>
    <xs:simpleType name="PIOPackageNameEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="ch.systransis.tag.server.get"/>
            <xs:enumeration value="ch.systransis.arl.pi"/>
            <xs:enumeration value="ch.systransis.ta.pi"/>
            <xs:enumeration value="ch.systransis.tag.pi"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc"/>
        </xs:restriction>
    </xs:simpleType>
    <xs:simpleType name="SpeedLimitAreaClassEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="ch.systransis.arl.pi.RbcSpeedLimitArea"/>
        </xs:restriction>
    </xs:simpleType>
    <xs:simpleType name="PIOClassNameEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="CodePoint"/>
            <xs:enumeration value="ch.systransis.arl.pi.CodePoint"/>
            <xs:enumeration value="ElectricalSeparationDangerRegion"/>
            <xs:enumeration value="ch.systransis.tag.server.get.ElectricalSeparationDangerRegion"/>
            <xs:enumeration value="GSMRzelle"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc.GSMRzelle"/>
            <xs:enumeration value="KlimaState"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc.KlimaState"/>
            <xs:enumeration value="MaintenanceRegion"/>
            <xs:enumeration value="ch.systransis.arl.pi.MaintenanceRegion"/>
            <xs:enumeration value="NamedRegion"/>
            <xs:enumeration value="ch.systransis.arl.pi.NamedRegion"/>
            <xs:enumeration value="NeutralSection"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc.NeutralSection"/>
            <xs:enumeration value="PowerSupplyRegion"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc.PowerSupplyRegion"/>
            <xs:enumeration value="PowerSupplyRegionSWT"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc.PowerSupplyRegionSWT"/>
            <xs:enumeration value="RailRoadSwitch"/>
            <xs:enumeration value="ch.systransis.arl.pi.RailRoadSwitch"/>
            <xs:enumeration value="RiAbhSp"/>
            <xs:enumeration value="ch.systransis.arl.pi.RiAbhSp"/>
            <xs:enumeration value="Sperre"/>
            <xs:enumeration value="ch.systransis.arl.pi.Sperre"/>
            <xs:enumeration value="StoppingRegion"/>
            <xs:enumeration value="ch.systransis.arl.pi.StoppingRegion"/>
            <xs:enumeration value="Stromversorgung50Hz"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc.Stromversorgung50Hz"/>
            <xs:enumeration value="TAGZNField"/>
            <xs:enumeration value="ch.systransis.tag.pi.TAGZNField"/>
            <xs:enumeration value="TARBCTrackEdge"/>
            <xs:enumeration value="ch.systransis.ta.pi.TARBCTrackEdge"/>
            <xs:enumeration value="TCD"/>
            <xs:enumeration value="ch.systransis.arl.pi.TCD"/>
            <xs:enumeration value="TAGSWT"/>
            <xs:enumeration value="ch.systransis.ta.pi.TAGSWT"/>
            <xs:enumeration value="Tube"/>
            <xs:enumeration value="ch.systransis.ta.pi.Tube"/>
            <xs:enumeration value="Tunnelfunkzelle"/>
            <xs:enumeration value="ch.systransis.tag.ifs.opc.Tunnelfunkzelle"/>
            <xs:enumeration value="ZLVRegion"/>
            <xs:enumeration value="ch.systransis.arl.pi.ZLVRegion"/>
        </xs:restriction>
    </xs:simpleType>
    <xs:simpleType name="PIOAttrNameEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="acceptNotMainSignalEnd"/>
            <xs:enumeration value="AdjacentRegions"/>
            <xs:enumeration value="alias"/>
            <xs:enumeration value="annoucementType"/>
            <xs:enumeration value="announceToOBU"/>
            <xs:enumeration value="center"/>
            <xs:enumeration value="createHeartCodePoint"/>
            <xs:enumeration value="controlledAreaEntry"/>
            <xs:enumeration value="controlledAreaExit"/>
            <xs:enumeration value="controlledByExternal"/>
            <xs:enumeration value="followingZNFields"/>
            <xs:enumeration value="directed"/>
            <xs:enumeration value="IgnoredBranch"/>
            <xs:enumeration value="L0field"/>
            <xs:enumeration value="leftStartPos"/>
            <xs:enumeration value="logEstimates"/>
            <xs:enumeration value="MainSignal"/>
            <xs:enumeration value="noMandate"/>
            <xs:enumeration value="offset"/>
            <xs:enumeration value="OppositeRegions"/>
            <xs:enumeration value="occForwardDestinations"/>
            <xs:enumeration value="possibleReasons"/>
            <xs:enumeration value="precedingZNFields"/>
            <xs:enumeration value="regionBorders"/>
            <xs:enumeration value="rightStartPos"/>
            <xs:enumeration value="spwportal"/>
            <xs:enumeration value="TCDs"/>
            <xs:enumeration value="ZelleName"/>
            <xs:enumeration value="ZNFields"/>
            <xs:enumeration value="znHandOver"/>
        </xs:restriction>
    </xs:simpleType>
    <xs:simpleType name="PathAttrNameEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="Orientation"/>
        </xs:restriction>
    </xs:simpleType>

    <!-- root element -->
    <xs:element name="ProcessImageConfig">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="EvacuationPaths"/>
                <xs:element ref="Mileages"/>
                <xs:element ref="PIOs"/>
                <xs:element ref="States"/>
                <xs:element ref="StaticSpeedProfile"/>
                <xs:element ref="Topology"/>
            </xs:choice>
            <xs:attribute type="xs:string" name="version" use="required"/>
        </xs:complexType>

        <!-- uniqueness requirements -->
        <xs:unique name="unique-EvacuationPath-id">
            <xs:selector xpath=".//EvacuationPath"/>
            <xs:field xpath="@id"/>
        </xs:unique>
        <xs:unique name="unique-Mileage-name">
            <xs:selector xpath=".//Mileage"/>
            <xs:field xpath="@name"/>
        </xs:unique>
        <xs:unique name="unique-State-id">
            <xs:selector xpath=".//State"/>
            <xs:field xpath="@id"/>
        </xs:unique>
        <xs:unique name="unique-SpeedLimitArea-name">
            <xs:selector xpath=".//SpeedLimitArea"/>
            <xs:field xpath="@name"/>
        </xs:unique>
        <xs:unique name="unique-PIO-classNameAndId">
            <xs:selector xpath=".//PIO"/>
            <xs:field xpath="@className"/>
            <xs:field xpath="@id"/>
        </xs:unique>
    </xs:element>

    <!-- Children of root -->
    <xs:element name="EvacuationPaths">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="EvacuationPath"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>
    <xs:element name="Mileages">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="Mileage"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>
    <xs:element name="PIOs">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="PIO"/>
            </xs:choice>
            <xs:attribute type="PIOPackageNameEnum" name="packageName" use="optional"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="States">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="State"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>
    <xs:element name="StaticSpeedProfile">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="SpeedLimitArea"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>
    <xs:element name="Topology">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="Twins"/>
                <xs:element ref="Segment"/>
                <xs:element ref="Border"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>

    <!-- Twins, Segment and V(ertex) -->
    <xs:element name="Twins">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="V"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>
    <xs:element name="Segment">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="V"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>
    <xs:element name="V">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="Alias"/>
                <xs:element ref="PIOAttr"/>
            </xs:choice>
            <xs:attribute type="xs:string" name="name" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="Border">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="V"/>
            </xs:choice>
        </xs:complexType>
    </xs:element>

    <!-- EvacuationPath and its child elements -->
    <xs:element name="EvacuationPath">
        <xs:complexType>
            <xs:attribute type="xs:string" name="id" use="required"/>
            <xs:attribute type="xs:string" name="via" use="required"/>
            <xs:attribute type="xs:string" name="disKriDPoints" use="required"/>
        </xs:complexType>
    </xs:element>


    <!-- Mileage and its child elements -->
    <xs:element name="Mileage">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="Anchor"/>
            </xs:choice>
            <xs:attribute type="xs:string" name="name" use="required"/>
            <xs:attribute type="xs:integer" name="min" use="optional"/>
            <xs:attribute type="xs:integer" name="max" use="optional"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="Anchor">
        <xs:complexType>
            <xs:attribute type="xs:string" name="mileageName" use="optional"/>
            <xs:attribute type="xs:integer" name="pos" use="required"/>
            <xs:attribute type="xs:string" name="vertexName" use="required"/>
            <xs:attribute type="MileageOrientationEnum" name="orientation" use="required"/>
        </xs:complexType>
    </xs:element>
    <!-- State and its child elements -->
    <xs:element name="State">
        <xs:complexType>
            <xs:attribute type="xs:string" name="id" use="required"/>
            <xs:attribute type="xs:string" name="initialState" use="required"/>
            <xs:attribute type="xs:string" name="className" use="optional"/>
        </xs:complexType>
    </xs:element>
    <!-- SpeedLimitArea and its child elements -->
    <xs:element name="SpeedLimitArea">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="PIOAttr"/>
                <xs:element ref="PIOPath"/>
                <xs:element ref="TrainCategory"/>
                <xs:element ref="AxleLoad"/>
            </xs:choice>
            <xs:attribute type="SpeedLimitAreaClassEnum" name="className" use="required"/>
            <xs:attribute type="xs:string" name="name" use="required"/>
            <xs:attribute type="xs:integer" name="speed" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="TrainCategory">
        <xs:complexType>
            <xs:attribute type="xs:string" name="kind" use="required"/>
            <xs:attribute type="xs:integer" name="speed" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="AxleLoad">
        <xs:complexType>
            <xs:attribute type="xs:integer" name="weight" use="required"/>
            <xs:attribute type="xs:integer" name="speed" use="required"/>
        </xs:complexType>
    </xs:element>
    <!-- PIO and its child elements -->
    <xs:element name="PIO">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="PIOLocation"/>
                <xs:element ref="Alias"/>
                <xs:element ref="PIOAttr"/>
                <xs:element ref="PIOPath"/>
                <xs:element ref="NoPath"/>
            </xs:choice>
            <xs:attribute type="xs:string" name="id" use="required"/>
            <xs:attribute type="PIOClassNameEnum" name="className" use="required"/>
        </xs:complexType>
        <!-- uniqueness requirements -->
        <xs:unique name="unique-PIOAttr-name">
            <xs:selector xpath="PIOAttr"/>
            <xs:field xpath="@name"/>
        </xs:unique>
    </xs:element>
    <xs:element name="PIOLocation">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="Waypoint"/>
            </xs:choice>
            <xs:attribute type="DescTypeEnum" name="descType" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="Alias">
        <xs:complexType>
            <xs:attribute type="xs:string" name="otherName" use="required"/>
            <xs:attribute type="xs:string" name="nameSpace" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="PIOAttr">
        <xs:complexType>
            <xs:attribute type="PIOAttrNameEnum" name="name" use="required"/>
            <xs:attribute type="xs:string" name="value" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="PIOPath">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="1">
                <xs:element ref="Waypoint"/>
                <xs:element ref="PathAttr"/>
            </xs:choice>
            <xs:attribute type="xs:string" name="descType" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="PathAttr">
        <xs:complexType>
            <xs:attribute type="PathAttrNameEnum" name="name" use="required"/>
            <xs:attribute type="xs:string" name="value" use="required"/>
        </xs:complexType>
    </xs:element>
    <xs:element name="NoPath">
        <xs:complexType>
        </xs:complexType>
    </xs:element>
    <xs:element name="Waypoint">
        <xs:complexType>
            <xs:attribute type="xs:string" name="desc" use="required"/>
        </xs:complexType>
    </xs:element>

</xs:schema>
