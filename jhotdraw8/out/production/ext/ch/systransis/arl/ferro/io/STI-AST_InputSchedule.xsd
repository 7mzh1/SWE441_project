<?xml version="1.0"?>
<!-- @(#)STI-AST_InputSchedule.xsd
Copyright (c) systransis Ltd.
All rights reserved.
-->

<xs:schema version="1.0"
           xmlns:xs="http://www.w3.org/2001/XMLSchema"
           elementFormDefault="qualified">
    <!-- attribute type declarations -->
    <xs:simpleType name="TrainClassEnum">
        <xs:restriction base="xs:string">
            <xs:enumeration value="FREIGHT_TRAIN"/>
            <xs:enumeration value="PASSENGER_TRAIN"/>
        </xs:restriction>
    </xs:simpleType>

    <!-- root element -->
    <xs:element name="inputSchedule">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="inputScheduleEntry"/>
            </xs:choice>
        </xs:complexType>

        <!-- uniqueness requirements -->
        <xs:unique name="unique-inputScheduleEntry-trainId">
            <xs:selector xpath=".//inputScheduleEntry"/>
            <xs:field xpath="@trainId"/>
        </xs:unique>
    </xs:element>

    <!-- Children of root -->
    <xs:element name="inputScheduleEntry">
        <xs:complexType>
            <xs:choice maxOccurs="unbounded" minOccurs="0">
                <xs:element ref="wayPoint"/>
            </xs:choice>
            <xs:attribute type="xs:string" name="trainId" use="required"/>
            <xs:attribute type="TrainClassEnum" name="trainClass" use="required"/>
            <!-- the length is in meters. -->
            <xs:attribute type="xs:integer" name="trainLength" use="required"/>
            <!-- the weight is in metric tons. -->
            <xs:attribute type="xs:integer" name="weight" use="required"/>
            <xs:attribute type="xs:string" name="lineId" use="required"/>
            <xs:attribute type="xs:string" name="directionId" use="required"/>
        </xs:complexType>
    </xs:element>
    <!-- Children of InputScheduleEntry -->
    <xs:element name="wayPoint">
        <xs:complexType>
            <xs:attribute type="xs:string" name="stationId" use="required"/>
            <xs:attribute type="xs:string" name="name" use="optional"/>
            <xs:attribute type="xs:boolean" name="isStopping" use="required"/>
            <!-- The format of arrivalTime and departureTime is "h:mm".
                   The time is relative to noon of the production date minus 12 hours.
                   The hours part "h" may be greater than 23 for trains which driver over midnight.
                               -->
            <xs:attribute type="xs:string" name="arrivalTime" use="optional"/>
            <xs:attribute type="xs:string" name="departureTime" use="optional"/>
        </xs:complexType>
    </xs:element>
</xs:schema>
